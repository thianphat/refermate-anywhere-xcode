(()=>{var e={6961:(e,t,r)=>{var n,o=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",n={};function o(e,t){if(!n[e]){n[e]={};for(var r=0;r<e.length;r++)n[e][e.charAt(r)]=r}return n[e][t]}var a={compressToBase64:function(e){if(null==e)return"";var r=a._compress(e,6,(function(e){return t.charAt(e)}));switch(r.length%4){default:case 0:return r;case 1:return r+"===";case 2:return r+"==";case 3:return r+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:a._decompress(e.length,32,(function(r){return o(t,e.charAt(r))}))},compressToUTF16:function(t){return null==t?"":a._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:a._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=a.compress(e),r=new Uint8Array(2*t.length),n=0,o=t.length;n<o;n++){var s=t.charCodeAt(n);r[2*n]=s>>>8,r[2*n+1]=s%256}return r},decompressFromUint8Array:function(t){if(null==t)return a.decompress(t);for(var r=new Array(t.length/2),n=0,o=r.length;n<o;n++)r[n]=256*t[2*n]+t[2*n+1];var s=[];return r.forEach((function(t){s.push(e(t))})),a.decompress(s.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":a._compress(e,6,(function(e){return r.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),a._decompress(e.length,32,(function(t){return o(r,e.charAt(t))})))},compress:function(t){return a._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,r){if(null==e)return"";var n,o,a,s={},u={},c="",i="",l="",f=2,d=3,p=2,h=[],v=0,y=0;for(a=0;a<e.length;a+=1)if(c=e.charAt(a),Object.prototype.hasOwnProperty.call(s,c)||(s[c]=d++,u[c]=!0),i=l+c,Object.prototype.hasOwnProperty.call(s,i))l=i;else{if(Object.prototype.hasOwnProperty.call(u,l)){if(l.charCodeAt(0)<256){for(n=0;n<p;n++)v<<=1,y==t-1?(y=0,h.push(r(v)),v=0):y++;for(o=l.charCodeAt(0),n=0;n<8;n++)v=v<<1|1&o,y==t-1?(y=0,h.push(r(v)),v=0):y++,o>>=1}else{for(o=1,n=0;n<p;n++)v=v<<1|o,y==t-1?(y=0,h.push(r(v)),v=0):y++,o=0;for(o=l.charCodeAt(0),n=0;n<16;n++)v=v<<1|1&o,y==t-1?(y=0,h.push(r(v)),v=0):y++,o>>=1}0==--f&&(f=Math.pow(2,p),p++),delete u[l]}else for(o=s[l],n=0;n<p;n++)v=v<<1|1&o,y==t-1?(y=0,h.push(r(v)),v=0):y++,o>>=1;0==--f&&(f=Math.pow(2,p),p++),s[i]=d++,l=String(c)}if(""!==l){if(Object.prototype.hasOwnProperty.call(u,l)){if(l.charCodeAt(0)<256){for(n=0;n<p;n++)v<<=1,y==t-1?(y=0,h.push(r(v)),v=0):y++;for(o=l.charCodeAt(0),n=0;n<8;n++)v=v<<1|1&o,y==t-1?(y=0,h.push(r(v)),v=0):y++,o>>=1}else{for(o=1,n=0;n<p;n++)v=v<<1|o,y==t-1?(y=0,h.push(r(v)),v=0):y++,o=0;for(o=l.charCodeAt(0),n=0;n<16;n++)v=v<<1|1&o,y==t-1?(y=0,h.push(r(v)),v=0):y++,o>>=1}0==--f&&(f=Math.pow(2,p),p++),delete u[l]}else for(o=s[l],n=0;n<p;n++)v=v<<1|1&o,y==t-1?(y=0,h.push(r(v)),v=0):y++,o>>=1;0==--f&&(f=Math.pow(2,p),p++)}for(o=2,n=0;n<p;n++)v=v<<1|1&o,y==t-1?(y=0,h.push(r(v)),v=0):y++,o>>=1;for(;;){if(v<<=1,y==t-1){h.push(r(v));break}y++}return h.join("")},decompress:function(e){return null==e?"":""==e?null:a._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,r,n){var o,a,s,u,c,i,l,f=[],d=4,p=4,h=3,v="",y=[],b={val:n(0),position:r,index:1};for(o=0;o<3;o+=1)f[o]=o;for(s=0,c=Math.pow(2,2),i=1;i!=c;)u=b.val&b.position,b.position>>=1,0==b.position&&(b.position=r,b.val=n(b.index++)),s|=(u>0?1:0)*i,i<<=1;switch(s){case 0:for(s=0,c=Math.pow(2,8),i=1;i!=c;)u=b.val&b.position,b.position>>=1,0==b.position&&(b.position=r,b.val=n(b.index++)),s|=(u>0?1:0)*i,i<<=1;l=e(s);break;case 1:for(s=0,c=Math.pow(2,16),i=1;i!=c;)u=b.val&b.position,b.position>>=1,0==b.position&&(b.position=r,b.val=n(b.index++)),s|=(u>0?1:0)*i,i<<=1;l=e(s);break;case 2:return""}for(f[3]=l,a=l,y.push(l);;){if(b.index>t)return"";for(s=0,c=Math.pow(2,h),i=1;i!=c;)u=b.val&b.position,b.position>>=1,0==b.position&&(b.position=r,b.val=n(b.index++)),s|=(u>0?1:0)*i,i<<=1;switch(l=s){case 0:for(s=0,c=Math.pow(2,8),i=1;i!=c;)u=b.val&b.position,b.position>>=1,0==b.position&&(b.position=r,b.val=n(b.index++)),s|=(u>0?1:0)*i,i<<=1;f[p++]=e(s),l=p-1,d--;break;case 1:for(s=0,c=Math.pow(2,16),i=1;i!=c;)u=b.val&b.position,b.position>>=1,0==b.position&&(b.position=r,b.val=n(b.index++)),s|=(u>0?1:0)*i,i<<=1;f[p++]=e(s),l=p-1,d--;break;case 2:return y.join("")}if(0==d&&(d=Math.pow(2,h),h++),f[l])v=f[l];else{if(l!==p)return null;v=a+a.charAt(0)}y.push(v),f[p++]=a+v.charAt(0),a=v,0==--d&&(d=Math.pow(2,h),h++)}}};return a}();void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n)},2408:(e,t)=>{"use strict";
/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),c=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,y={};function b(e,t,r){this.props=e,this.context=t,this.refs=y,this.updater=r||h}function m(){}function E(e,t,r){this.props=e,this.context=t,this.refs=y,this.updater=r||h}b.prototype.isReactComponent={},b.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},b.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},m.prototype=b.prototype;var g=E.prototype=new m;g.constructor=E,v(g,b.prototype),g.isPureReactComponent=!0;var S=Array.isArray,w=Object.prototype.hasOwnProperty,_={current:null},O={key:!0,ref:!0,__self:!0,__source:!0};function R(e,t,n){var o,a={},s=null,u=null;if(null!=t)for(o in void 0!==t.ref&&(u=t.ref),void 0!==t.key&&(s=""+t.key),t)w.call(t,o)&&!O.hasOwnProperty(o)&&(a[o]=t[o]);var c=arguments.length-2;if(1===c)a.children=n;else if(1<c){for(var i=Array(c),l=0;l<c;l++)i[l]=arguments[l+2];a.children=i}if(e&&e.defaultProps)for(o in c=e.defaultProps)void 0===a[o]&&(a[o]=c[o]);return{$$typeof:r,type:e,key:s,ref:u,props:a,_owner:_.current}}function T(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var C=/\/+/g;function A(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function x(e,t,o,a,s){var u=typeof e;"undefined"!==u&&"boolean"!==u||(e=null);var c=!1;if(null===e)c=!0;else switch(u){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case r:case n:c=!0}}if(c)return s=s(c=e),e=""===a?"."+A(c,0):a,S(s)?(o="",null!=e&&(o=e.replace(C,"$&/")+"/"),x(s,t,o,"",(function(e){return e}))):null!=s&&(T(s)&&(s=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,o+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(C,"$&/")+"/")+e)),t.push(s)),1;if(c=0,a=""===a?".":a+":",S(e))for(var i=0;i<e.length;i++){var l=a+A(u=e[i],i);c+=x(u,t,o,l,s)}else if(l=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"==typeof l)for(e=l.call(e),i=0;!(u=e.next()).done;)c+=x(u=u.value,t,o,l=a+A(u,i++),s);else if("object"===u)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function U(e,t,r){if(null==e)return e;var n=[],o=0;return x(e,n,"","",(function(e){return t.call(r,e,o++)})),n}function k(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},N={transition:null},j={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:N,ReactCurrentOwner:_};t.Children={map:U,forEach:function(e,t,r){U(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return U(e,(function(){t++})),t},toArray:function(e){return U(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=b,t.Fragment=o,t.Profiler=s,t.PureComponent=E,t.StrictMode=a,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j,t.cloneElement=function(e,t,n){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=v({},e.props),a=e.key,s=e.ref,u=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,u=_.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(i in t)w.call(t,i)&&!O.hasOwnProperty(i)&&(o[i]=void 0===t[i]&&void 0!==c?c[i]:t[i])}var i=arguments.length-2;if(1===i)o.children=n;else if(1<i){c=Array(i);for(var l=0;l<i;l++)c[l]=arguments[l+2];o.children=c}return{$$typeof:r,type:e.type,key:a,ref:s,props:o,_owner:u}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:u,_context:e},e.Consumer=e},t.createElement=R,t.createFactory=function(e){var t=R.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:i,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:k}},t.memo=function(e,t){return{$$typeof:f,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=N.transition;N.transition={};try{e()}finally{N.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,r){return P.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,r){return P.current.useReducer(e,t,r)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return P.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return P.current.useTransition()},t.version="18.2.0"},7294:(e,t,r)=>{"use strict";e.exports=r(2408)},9316:(e,t,r)=>{"use strict";r.d(t,{FH:()=>n,H5:()=>a,Hu:()=>o,Kl:()=>s});var n="https://refermate.com",o={LOCK_SCREEN:"lock-screen",UNLOCK_SCREEN:"unlock-screen",OPEN_AFFILIATE_URL:"open_affliate",FETCH_USER:"refer-user-data",FAV_STORE:"favourite-store",UNFAV_STORE:"unfavourite-store",FETCH_STORE_DETAILS:"store-details",FETCH_ALL_STORES:"fetch-all-stores",HOSTPAGE_SEND_FETCH_STORE_DETAILS:"hostpage-store-details",COOKIE:"cookie",RELAY_COOKIE:"relay-cookie",POPUP_UPDATE_CONTENTSCRIPT_STORAGE:"popup-update-content-storage",OPEN_POPUP:"clicked_browser_action",UPDATE_STORE_DETAILS:"update-store-details",RESET_STORAGE_FOR_POPUP:"reset-storage",SUPPORTED_STORE:"supported-store",UNSUPPORTED_STORE:"unsupported-store",AHOY:"ahoy",FEEDBACK:"feedback",CHECK_USER_AUTHENTICATION:"is-user-signed-in",CHECKOUT_PAGE:"checkout-page",APPLY_COUPONS:"apply-coupons",APPLY_COUPONS_CALL:"apply-coupons"},a={REFERMATE_USER:"refermate-user",REFERMATE_STOREDETAILS:"refermate-storedetails-",REFERMATE_ENTIRE_STORE:"refermate-allStores",REFERMATE_FAVOURITE_STORE:"refermate-favourite",REFERMATE_UNFAVOURITE_STORE:"refermate-unfavourite"},s=7200},5091:(e,t,r)=>{"use strict";r.d(t,{bp:()=>s,ve:()=>a});r(3224);var n=function(e,t,r,n){return new(r||(r=Promise))((function(o,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function u(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}c((n=n.apply(e,t||[])).next())}))},o=function(e,t){var r,n,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){s=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){s.label=u[1];break}if(6===u[0]&&s.label<o[1]){s.label=o[1],o=u;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(u);break}o[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(e,s)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},a=function(e){return 60*e*1e3};function s(e,t,r,a){return n(this,void 0,void 0,(function(){var n,s,u,c;return o(this,(function(o){switch(o.label){case 0:return n=t?"".concat(e).concat(t):"".concat(e),s=new Date,u={value:r,expiry:s.getTime()+a},[4,chrome.storage.local.set((c={},c[n]=JSON.stringify(a?u:{value:r}),c))];case 1:return o.sent(),[2]}}))}))}},1666:(e,t,r)=>{"use strict";r.d(t,{U:()=>c});var n=r(9316),o=r(8721),a=(r(5091),r(3224),function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)}),s=function(e,t,r,n){return new(r||(r=Promise))((function(o,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function u(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}c((n=n.apply(e,t||[])).next())}))},u=function(e,t){var r,n,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){s=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){s.label=u[1];break}if(6===u[0]&&s.label<o[1]){s.label=o[1],o=u;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(u);break}o[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(e,s)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},c=function(e){return s(void 0,void 0,void 0,(function(){var t,r,s,c,i,l,f,d,p,h;return u(this,(function(u){switch(u.label){case 0:return[4,chrome.storage.local.get(["currentStoreData"])];case 1:return t=u.sent().currentStoreData,[4,chrome.storage.sync.get(["userExtensionId"])];case 2:return s=u.sent().userExtensionId,[4,chrome.storage.local.get(["refermate-user"])];case 3:return c=u.sent(),i=0!==Object.keys(c).length?JSON.parse(c["refermate-user"]):null,l=i?JSON.parse(null==i?void 0:i.value):null,r=s,s?[3,5]:(f=(0,o.Z)(),[4,chrome.storage.sync.set({userExtensionId:(0,o.Z)()})]);case 4:u.sent(),r=f,u.label=5;case 5:return u.trys.push([5,9,,10]),d={name:"Extension 2 - "+e.eventName,properties:{location:e.location,domain:e.domain||t.store_name,store_id:e.store_id||(null==t?void 0:t.store_id)||0,errorCatchReason:e.errorCatchReason,errorEvent:e.errorEvent,errorMessage:e.errorMessage,user_extension_id:r,version:chrome.runtime.getManifest().version,device:a({},e.device),user_id:(null===(h=null==l?void 0:l.user)||void 0===h?void 0:h.id)||null}},void 0===e.domain?[3,8]:[4,fetch(n.FH+"/ahoy_add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})];case 6:return[4,u.sent().json()];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:return p=u.sent(),console.error("ahoyError",p),[3,10];case 10:return[2]}}))}))}},3306:(e,t,r)=>{"use strict";r.d(t,{g:()=>n});var n=function(e){var t=e||window.location.hostname,r=e||window.location.href,n=r.includes("ranSiteID")&&!r.includes("WN6MZoSkmIs"),o=r.includes("developer."),a=r.includes("app."),s=r.includes("refermate.");return{domain:t=n||o||a||s?null:t.replace(/^cart./,"").replace("http://","").replace("https://","").replace("www.","").replace("www2.","").split(/[/?#]/)[0]}}},189:(e,t,r)=>{"use strict";function n(){var e,t,r,n=!!(null===(e=null===navigator||void 0===navigator?void 0:navigator.platform)||void 0===e?void 0:e.match(/iPhone|iPod|iPad/)),o=-1!==(null===(r=null===(t=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===t?void 0:t.toLowerCase())||void 0===r?void 0:r.indexOf("android"));return n||o}r.d(t,{SB:()=>s,nH:()=>a,vS:()=>u});var o=function(){if("undefined"!=typeof window&&"undefined"!=typeof navigator){var e=null===navigator||void 0===navigator?void 0:navigator.userAgent;return e.match(/chrome|chromium|crios/i)?"chrome":e.match(/firefox|fxios/i)?"firefox":e.match(/safari/i)?"safari":e.match(/opr\//i)?"opera":e.match(/edg/i)?"edge":"No browser detection"}},a=function(){var e,t;return{manufacturer:"undefined"!=typeof window||"undefined"!=typeof navigator?null===navigator||void 0===navigator?void 0:navigator.vendor:"",model:n()?"mobile":"desktop",name:o()||"",type:"browser",version:(null===(t=null===(e=null===navigator||void 0===navigator?void 0:navigator.userAgentData)||void 0===e?void 0:e.brands[0])||void 0===t?void 0:t.version)||""}},s="browser"===a().type&&"safari"===a().name&&"mobile"===a().model,u="browser"===a().type&&"safari"===a().name&&"desktop"===a().model},7516:(e,t,r)=>{"use strict";r.d(t,{SW:()=>a});var n=r(3445),o={},a=(0,n.Ue)((function(e){return{stores:o,actions:{setStore:function(t){e((function(){return{stores:t}}))}}}}))},9929:(e,t,r)=>{"use strict";r.d(t,{LM:()=>o});var n=r(3445),o=(0,n.Ue)((function(e){return{user:null,actions:{setUser:function(t){e((function(){return{user:t}}))}}}}))},3250:(e,t,r)=>{"use strict";
/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(7294);var o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=n.useState,s=n.useEffect,u=n.useLayoutEffect,c=n.useDebugValue;function i(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!o(e,r)}catch(e){return!0}}var l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),n=a({inst:{value:r,getSnapshot:t}}),o=n[0].inst,l=n[1];return u((function(){o.value=r,o.getSnapshot=t,i(o)&&l({inst:o})}),[e,r,t]),s((function(){return i(o)&&l({inst:o}),e((function(){i(o)&&l({inst:o})}))}),[e]),c(r),r};t.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:l},139:(e,t,r)=>{"use strict";
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(7294),o=r(1688);var a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=o.useSyncExternalStore,u=n.useRef,c=n.useEffect,i=n.useMemo,l=n.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,r,n,o){var f=u(null);if(null===f.current){var d={hasValue:!1,value:null};f.current=d}else d=f.current;f=i((function(){function e(e){if(!c){if(c=!0,s=e,e=n(e),void 0!==o&&d.hasValue){var t=d.value;if(o(t,e))return u=t}return u=e}if(t=u,a(s,e))return t;var r=n(e);return void 0!==o&&o(t,r)?t:(s=e,u=r)}var s,u,c=!1,i=void 0===r?null:r;return[function(){return e(t())},null===i?void 0:function(){return e(i())}]}),[t,r,n,o]);var p=s(e,f[0],f[1]);return c((function(){d.hasValue=!0,d.value=p}),[p]),l(p),p}},1688:(e,t,r)=>{"use strict";e.exports=r(3250)},2798:(e,t,r)=>{"use strict";e.exports=r(139)},8721:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});const n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let o;const a=new Uint8Array(16);function s(){if(!o&&(o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!o))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(a)}const u=[];for(let e=0;e<256;++e)u.push((e+256).toString(16).slice(1));function c(e,t=0){return(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase()}const i=function(e,t,r){if(n.randomUUID&&!t&&!e)return n.randomUUID();const o=(e=e||{}).random||(e.rng||s)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=o[e];return t}return c(o)}},3224:(e,t,r)=>{"use strict";
/*! typescript-cookie v1.0.4 | MIT */const n=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),o=e=>encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent),a=decodeURIComponent,s=e=>('"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent));function u(e,t,r){const n=/(?:^|; )([^=]*)=([^;]*)/g,o={};let a;for(;null!=(a=n.exec(document.cookie));)try{const n=r(a[1]);if(o[n]=t(a[2],n),e===n)break}catch(e){}return null!=e?o[e]:o}const c=Object.freeze({decodeName:a,decodeValue:s,encodeName:n,encodeValue:o}),i=Object.freeze({path:"/"});function l(e,t,r=i,{encodeValue:a=o,encodeName:s=n}={}){return document.cookie=`${s(e)}=${a(t,e)}${function(e){return"number"==typeof(e=Object.assign({},e)).expires&&(e.expires=new Date(Date.now()+864e5*e.expires)),null!=e.expires&&(e.expires=e.expires.toUTCString()),Object.entries(e).filter((([e,t])=>null!=t&&!1!==t)).map((([e,t])=>!0===t?`; ${e}`:`; ${e}=${t.split(";")[0]}`)).join("")}(r)}`}function f(e,{decodeValue:t=s,decodeName:r=a}={}){return u(e,t,r)}function d({decodeValue:e=s,decodeName:t=a}={}){return u(void 0,e,t)}(function e(t,r){const n={set:function(e,t,r){return l(e,t,Object.assign({},this.attributes,r),{encodeValue:this.converter.write})},get:function(e){return 0===arguments.length?d(this.converter.read):null!=e?f(e,this.converter.read):void 0},remove:function(e,t){!function(e,t=i){l(e,"",Object.assign({},t,{expires:-1}))}(e,Object.assign({},this.attributes,t))},withAttributes:function(t){return e(this.converter,Object.assign({},this.attributes,t))},withConverter:function(t){return e(Object.assign({},this.converter,t),this.attributes)}},o={attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}};return Object.create(n,o)})({read:c.decodeValue,write:c.encodeValue},i)},3445:(e,t,r)=>{"use strict";r.d(t,{Ue:()=>c});var n=r(3973),o=r(7294),a=r(2798);const{useSyncExternalStoreWithSelector:s}=a;const u=e=>{"function"!=typeof e&&console.warn('[DEPRECATED] Passing a vanilla store will be unsupported in the future version. Please use `import { useStore } from "zustand"` to use the vanilla store in React.');const t="function"==typeof e?(0,n.M)(e):e,r=(e,r)=>function(e,t=e.getState,r){const n=s(e.subscribe,e.getState,e.getServerState||e.getState,t,r);return(0,o.useDebugValue)(n),n}(t,e,r);return Object.assign(r,t),r},c=e=>e?u(e):u},3973:(e,t,r)=>{"use strict";r.d(t,{M:()=>o});const n=e=>{let t;const r=new Set,n=(e,n)=>{const o="function"==typeof e?e(t):e;if(!Object.is(o,t)){const e=t;t=(null!=n?n:"object"!=typeof o)?o:Object.assign({},t,o),r.forEach((r=>r(t,e)))}},o=()=>t,a={setState:n,getState:o,subscribe:e=>(r.add(e),()=>r.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The destroy method will be unsupported in the future version. You should use unsubscribe function returned by subscribe. Everything will be garbage collected if store is garbage collected."),r.clear()}};return t=e(n,o,a),a},o=e=>e?n(e):n}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=r(6961),t=r.n(e),n=r(9316),o=r(5091),a=r(1666),s=r(8721),u=function(e,t,r,n){return new(r||(r=Promise))((function(o,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function u(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}c((n=n.apply(e,t||[])).next())}))},c=function(e,t){var r,n,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){s=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){s.label=u[1];break}if(6===u[0]&&s.label<o[1]){s.label=o[1],o=u;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(u);break}o[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(e,s)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},i=r(3306),l=function(e,t,r,n){return new(r||(r=Promise))((function(o,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function u(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}c((n=n.apply(e,t||[])).next())}))},f=function(e,t){var r,n,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){s=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){s.label=u[1];break}if(6===u[0]&&s.label<o[1]){s.label=o[1],o=u;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(u);break}o[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(e,s)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};const d=function(e){return l(void 0,void 0,void 0,(function(){var r,o,a,s,u,c,i;return f(this,(function(l){switch(l.label){case 0:return e?[4,chrome.storage.local.get(n.H5.REFERMATE_ENTIRE_STORE)]:[2];case 1:return r=l.sent(),Object.keys(r).length?[4,JSON.parse(t().decompressFromUTF16(JSON.parse(r[n.H5.REFERMATE_ENTIRE_STORE]).value))]:[2,null];case 2:for(o=l.sent(),a=Object.values(o),s=0,u=a.length;s<u;++s)if((null===(c=a[s])||void 0===c?void 0:c.domains.includes(e))&&(null===(i=a[s])||void 0===i?void 0:i.ext))return[2,a[s]];return[2]}}))}))};var p=r(9929),h=r(7516),v=r(189);var y,b=function(){return b=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},b.apply(this,arguments)},m=function(e,t,r,n){return new(r||(r=Promise))((function(o,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function u(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}c((n=n.apply(e,t||[])).next())}))},E=function(e,t){var r,n,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){s=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){s.label=u[1];break}if(6===u[0]&&s.label<o[1]){s.label=o[1],o=u;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(u);break}o[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(e,s)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};console.log=function(){},console.error=function(){},console.debug=function(){};var g="";chrome.runtime.onMessage.addListener((function(e,t,r){return m(void 0,void 0,void 0,(function(){return E(this,(function(t){switch(t.label){case 0:return"create-tab"!==e.type?[3,2]:[4,chrome.tabs.update({url:e.options.url})];case 1:t.sent(),chrome.tabs.query({active:!0,lastFocusedWindow:!0}).then((function(e){var t;chrome.action.setBadgeText({text:"",tabId:null===(t=e[0])||void 0===t?void 0:t.id})})),t.label=2;case 2:return[2]}}))}))})),(v.SB||v.vS)&&chrome.storage.local.get(["extension_state"],(function(e){return m(void 0,void 0,void 0,(function(){return E(this,(function(t){return void 0===e.extension_state&&chrome.tabs.create({url:"https://www.google.com"}).then((function(e){return m(void 0,void 0,void 0,(function(){return E(this,(function(e){switch(e.label){case 0:return[4,chrome.storage.local.set({extension_state:"installed"})];case 1:return e.sent(),[4,chrome.action.setBadgeText({text:"Allow Permissions"})];case 2:return e.sent(),[2]}}))}))})),[2]}))}))})),m(void 0,void 0,void 0,(function(){var e,t,r;return E(this,(function(n){switch(n.label){case 0:return[4,chrome.tabs.query({active:!0,currentWindow:!0})];case 1:return e=n.sent()[0],t=(0,i.g)(e.url).domain,[4,d(t)];case 2:return(r=n.sent())?[4,chrome.storage.local.set({currentDomain:t})]:[3,4];case 3:n.sent(),n.label=4;case 4:return r?[3,6]:[4,chrome.storage.local.set({currentDomain:null})];case 5:n.sent(),n.label=6;case 6:return[2]}}))})),chrome.tabs.onUpdated.addListener((function(e,t,r){return m(void 0,void 0,void 0,(function(){var e,r,n;return E(this,(function(o){switch(o.label){case 0:return[4,chrome.storage.local.get("currentDomain")];case 1:return e=o.sent(),t.url?(r=(0,i.g)(t.url).domain)===e?[3,6]:[4,d(r)]:[3,6];case 2:return(n=o.sent())?[4,chrome.storage.local.set({currentDomain:r})]:[3,4];case 3:o.sent(),o.label=4;case 4:return n?[3,6]:[4,chrome.storage.local.set({currentDomain:null})];case 5:o.sent(),o.label=6;case 6:return[2]}}))}))})),chrome.tabs.query({active:!0,currentWindow:!0}).then((function(e){var t=e[0];(0,i.g)(t.url)})),chrome.runtime.onInstalled.addListener((function(e){return v.SB&&v.vS||e&&"install"===e.reason&&(chrome.storage.sync.set({userExtensionId:(0,s.Z)()}),chrome.storage.local.set({refermateTutorial:[]}),chrome.tabs.query({url:"*://*.refermate.com/*"},(function(e){0===e.length&&chrome.tabs.create({url:n.FH+"/extension_installed"},(function(){(0,a.U)({domain:"refermate.com",eventName:"Extension Install",location:"background",device:(0,v.nH)(),version:chrome.runtime.getManifest().version}).then()}))}))),e&&"update"===e.reason&&(0,a.U)({domain:"refermate.com",eventName:"Extension Update",location:"background",version:chrome.runtime.getManifest().version}),e.reason===chrome.runtime.OnInstalledReason.INSTALL&&chrome.runtime.setUninstallURL("".concat(n.FH,"/extension_uninstalled")),!0})),chrome.tabs.onUpdated.addListener((function(e,t){return"complete"===t.status&&chrome.tabs.sendMessage(e,{message:"Updated"},(function(e){return console.log(e)})),!0})),null===(y=chrome.webNavigation)||void 0===y||y.onBeforeNavigate.addListener((function(e){return m(void 0,void 0,void 0,(function(){var t;return E(this,(function(r){switch(r.label){case 0:return e.url!==g?[3,2]:[4,chrome.tabs.query({active:!0,lastFocusedWindow:!0})];case 1:(t=r.sent()[0])&&"id"in t&&chrome.tabs.sendMessage(t.id,{message:"reloaded"},(function(e){console.log(e)})),r.label=2;case 2:return g=e.url,console.log(g),[2,!0]}}))}))}));var S=function(e){return m(void 0,void 0,void 0,(function(){var t;return E(this,(function(r){switch(r.label){case 0:return[4,chrome.tabs.query({active:!0,lastFocusedWindow:!0})];case 1:return(null==(t=r.sent()[0])?void 0:t.id)?[4,chrome.tabs.sendMessage(t.id,e,(function(e){return console.log("respondToContentscript",e)}))]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},w=function(e){return m(void 0,void 0,void 0,(function(){var t,r;return E(this,(function(o){switch(o.label){case 0:if(!e)return[2];o.label=1;case 1:return o.trys.push([1,6,,7]),[4,fetch("https://refermate.com/extension?ver=2&scope=user,activity,transactions,store_subscriptions,liked_products")];case 2:return[4,o.sent().json()];case 3:return t=o.sent(),console.log("USER 1: FETCHING DATA FROM:",e,t.user),t.user?[3,5]:(p.LM.getState().actions.setUser(null),[4,chrome.storage.local.remove(n.H5.REFERMATE_USER)]);case 4:o.sent(),o.label=5;case 5:return[3,7];case 6:return r=o.sent(),console.log("Error checking user authentication:",r),[3,7];case 7:return[2]}}))}))};chrome.runtime.onMessage.addListener((function(e,r,s){return m(void 0,void 0,void 0,(function(){var r,i,l,f,p,v,y,g,_,O,R,T,C,A,x,U,k;return E(this,(function(P){switch(P.label){case 0:switch(r="object"==typeof e&&Object.hasOwn(e,"type")?e.type:e,r){case n.Hu.LOCK_SCREEN:return[3,1];case n.Hu.UNLOCK_SCREEN:return[3,3];case n.Hu.CHECK_USER_AUTHENTICATION:return[3,5];case n.Hu.FETCH_USER:return[3,7];case n.Hu.FAV_STORE:return[3,8];case n.Hu.AHOY:return[3,9];case n.Hu.SUPPORTED_STORE:return[3,10];case n.Hu.UNSUPPORTED_STORE:return[3,11];case n.Hu.UNFAV_STORE:return[3,12];case n.Hu.COOKIE:return[3,13];case n.Hu.FEEDBACK:return[3,14];case n.Hu.RELAY_COOKIE:return[3,15];case n.Hu.OPEN_AFFILIATE_URL:return[3,16];case n.Hu.FETCH_STORE_DETAILS:return[3,18];case n.Hu.FETCH_ALL_STORES:return[3,19];case n.Hu.CHECKOUT_PAGE:return[3,20]}return[3,22];case 1:case 3:return[4,chrome.tabs.query({active:!0,lastFocusedWindow:!0})];case 2:return(null==(i=P.sent()[0])?void 0:i.id)&&chrome.tabs.sendMessage(i.id,{type:n.Hu.LOCK_SCREEN},(function(e){return console.log("respondToContentscript","Message: {lockContent: MESSAGE_TOPIC.LOCK_SCREEN")})),[3,22];case 4:return(null==(l=P.sent()[0])?void 0:l.id)&&chrome.tabs.sendMessage(l.id,{type:n.Hu.UNLOCK_SCREEN},(function(e){return console.log("respondToContentscript","Message: {lockContent: MESSAGE_TOPIC.UNLOCK_SCREEN")})),[3,22];case 5:return[4,w(e.sender)];case 6:return P.sent(),s(!0),[3,22];case 7:return function(e){return m(void 0,void 0,void 0,(function(){var t,r;return E(this,(function(a){switch(a.label){case 0:return a.trys.push([0,5,,6]),console.log("✅✅✅✅✅ fetchUserDetails request from %o",e),[4,fetch("https://refermate.com/extension?ver=2&scope=user,activity,transactions,store_subscriptions,liked_products")];case 1:return[4,a.sent().json()];case 2:return t=a.sent(),console.log("fetchUserDetails result res",t),t.user?(console.log("WE HAVE USER BUT WE ARE SETTING NOW...."),[4,(0,o.bp)(n.H5.REFERMATE_USER,null,JSON.stringify(t),null)]):[3,4];case 3:a.sent(),a.label=4;case 4:return[3,6];case 5:throw r=a.sent(),console.error("Error calling fetchUserDetails:",r),r;case 6:return[2]}}))}))}(e.sender).then((function(e){console.log("RESPONSE FROM BG",e),s(!0)})),[3,22];case 8:return(j=e.data,m(void 0,void 0,void 0,(function(){var e,t;return E(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,fetch(n.FH+"/stores/"+j.id+"/subscription.json",{method:"POST",body:JSON.stringify({subscribe:!0}),headers:{"content-type":"application/json"}})];case 1:return r.sent(),e={type:n.Hu.FAV_STORE,data:"subscribed"},[4,S(e)];case 2:return r.sent(),[3,4];case 3:throw t=r.sent(),console.error("Error storing favorite:",t),t;case 4:return[2]}}))}))).then((function(){return m(void 0,void 0,void 0,(function(){return E(this,(function(e){switch(e.label){case 0:return[4,chrome.storage.local.set({invalidatepopup:!0})];case 1:return e.sent(),[2]}}))}))})),s(!0),[3,22];case 9:return(0,a.U)(b({},e.ahoyData)).then(),s(!0),[3,22];case 10:return chrome.tabs?(f=e.data,chrome.tabs.query({active:!0,lastFocusedWindow:!0}).then((function(e){var t;0!==f.length&&chrome.action.setBadgeText({text:JSON.stringify(f.length),tabId:null===(t=e[0])||void 0===t?void 0:t.id})})),s(!0),[3,22]):[2];case 11:return chrome.tabs?(s(!0),[3,22]):[2];case 12:return function(e){return m(void 0,void 0,void 0,(function(){var t,r;return E(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,fetch(n.FH+"/stores/"+e.id+"/subscription.json",{method:"POST",body:JSON.stringify({subscribe:!1}),headers:{"content-type":"application/json"}})];case 1:return o.sent(),t={type:n.Hu.UNFAV_STORE,data:"removed"},[4,S(t)];case 2:return o.sent(),[3,4];case 3:throw r=o.sent(),console.error("Error calling unfavouriteStore:",r),r;case 4:return[2]}}))}))}(e.data).then((function(){return m(void 0,void 0,void 0,(function(){return E(this,(function(e){switch(e.label){case 0:return[4,chrome.storage.local.set({invalidatepopup:!0})];case 1:return e.sent(),[2]}}))}))})),s(!0),[3,22];case 13:return p=e.data,v=p.key,y=p.value,g=p.namespace,_=p.ttl,(0,o.bp)(v,g,y,(0,o.ve)(_)).then(),s(!0),[3,22];case 14:return(N={kind:"extension_rating",body:{feedbackText:e.data.feedback,stars:e.data.stars}},u(void 0,void 0,void 0,(function(){var e,t,r,o;return c(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),e={feedback:{kind:N.kind="extension_rating",body:N.body.feedbackText,star_rating:N.body.stars}},[4,fetch(n.FH+"/feedbacks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})];case 1:return[4,(t=a.sent()).json()];case 2:return r=a.sent(),t.ok&&console.log("👍 Feedback:",r,"\nResponse:",t),[3,4];case 3:return o=a.sent(),console.error("feedbackError",o),[3,4];case 4:return[2]}}))}))).then((function(){return s(!0)})),[3,22];case 15:return O=e.data,R=O.key,T=O.value,C=O.namespace,A=O.ttl,(0,o.bp)(R,C,T,(0,o.ve)(A)).then(),x={type:n.Hu.RELAY_COOKIE,data:{key:R,value:T,expiration:(0,o.ve)(A)}},S(x).then(),s(!0),[3,22];case 16:return[4,chrome.tabs.query({})];case 17:return U=P.sent(),""!==e.data.affiliateUrl?(console.log("All tabs",U),chrome.tabs.create({url:e.data.affiliateUrl,active:!1,pinned:!0},(function(e){setTimeout((function(){return m(void 0,void 0,void 0,(function(){var t,r,n,o,a;return E(this,(function(s){switch(s.label){case 0:return null==(null==e?void 0:e.id)?[3,6]:[4,chrome.tabs.remove(e.id)];case 1:return s.sent(),[4,chrome.tabs.query({})];case 2:if(t=s.sent(),r=function(e,t){for(var r=[],n=new Set(e.map((function(e){return e.id}))),o=0,a=t;o<a.length;o++){var s=a[o];n.has(s.id)||r.push(s)}return r}(Array.from(U),Array.from(t)),!(r.length>0))return[3,6];n=0,o=r,s.label=3;case 3:return n<o.length?(a=o[n],[4,chrome.tabs.remove(a.id)]):[3,6];case 4:s.sent(),s.label=5;case 5:return n++,[3,3];case 6:return[2]}}))}))}),8e3)}))):console.log("No affiliate URL to open"),s(!0),[3,22];case 18:return function(e,t){return m(void 0,void 0,void 0,(function(){var r,a,s;return E(this,(function(u){switch(u.label){case 0:return u.trys.push([0,5,,6]),[4,d(e)];case 1:return r=u.sent(),console.log("Step 4",r),r?[4,fetch("".concat(n.FH,"/extension?ver=2&domain=").concat(e))]:[2];case 2:return[4,u.sent().json()];case 3:return a=u.sent(),console.log("✅✅✅✅✅ fetchStoreDetails request from %o",t),[4,(0,o.bp)(n.H5.REFERMATE_STOREDETAILS,e,JSON.stringify(null==a?void 0:a.domains[0]),(0,o.ve)(n.Kl))];case 4:return u.sent(),[3,6];case 5:throw s=u.sent(),console.error("Error calling fetchStoreDetails:",s),s;case 6:return[2]}}))}))}(e.storeDomain,e.sender).then((function(){return s(!0)})),[3,22];case 19:return function(e){return m(void 0,void 0,void 0,(function(){var r,a,s;return E(this,(function(u){switch(u.label){case 0:return u.trys.push([0,4,,5]),console.log("🔥🔥🔥🔥🔥 fetchAllStores request from %o",e),[4,fetch(n.FH+"/extension?ver=2&store_list=true")];case 1:return[4,u.sent().json()];case 2:return r=u.sent(),a=JSON.parse(r.stores),[4,(0,o.bp)(n.H5.REFERMATE_ENTIRE_STORE,null,t().compressToUTF16(JSON.stringify(a)),(0,o.ve)(n.Kl))];case 3:return u.sent(),h.SW.getState().actions.setStore(a),[3,5];case 4:return s=u.sent(),console.log("Error fetching all stores:",s),[3,5];case 5:return[2]}}))}))}(e.sender).then((function(){return s(!0)})),[3,22];case 20:return[4,chrome.storage.local.set((k={},k[n.Hu.CHECKOUT_PAGE]=e.data,k))];case 21:return P.sent(),[3,22];case 22:return[2,!0]}var N,j}))}))}))})()})();