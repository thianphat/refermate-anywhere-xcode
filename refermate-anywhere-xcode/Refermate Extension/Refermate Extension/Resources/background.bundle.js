(()=>{var e={6961:(e,t,n)=>{var r,o=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function o(e,t){if(!r[e]){r[e]={};for(var n=0;n<e.length;n++)r[e][e.charAt(n)]=n}return r[e][t]}var a={compressToBase64:function(e){if(null==e)return"";var n=a._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:a._decompress(e.length,32,(function(n){return o(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":a._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:a._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=a.compress(e),n=new Uint8Array(2*t.length),r=0,o=t.length;r<o;r++){var s=t.charCodeAt(r);n[2*r]=s>>>8,n[2*r+1]=s%256}return n},decompressFromUint8Array:function(t){if(null==t)return a.decompress(t);for(var n=new Array(t.length/2),r=0,o=n.length;r<o;r++)n[r]=256*t[2*r]+t[2*r+1];var s=[];return n.forEach((function(t){s.push(e(t))})),a.decompress(s.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":a._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),a._decompress(e.length,32,(function(t){return o(n,e.charAt(t))})))},compress:function(t){return a._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var r,o,a,s={},c={},u="",i="",l="",f=2,d=3,p=2,h=[],v=0,m=0;for(a=0;a<e.length;a+=1)if(u=e.charAt(a),Object.prototype.hasOwnProperty.call(s,u)||(s[u]=d++,c[u]=!0),i=l+u,Object.prototype.hasOwnProperty.call(s,i))l=i;else{if(Object.prototype.hasOwnProperty.call(c,l)){if(l.charCodeAt(0)<256){for(r=0;r<p;r++)v<<=1,m==t-1?(m=0,h.push(n(v)),v=0):m++;for(o=l.charCodeAt(0),r=0;r<8;r++)v=v<<1|1&o,m==t-1?(m=0,h.push(n(v)),v=0):m++,o>>=1}else{for(o=1,r=0;r<p;r++)v=v<<1|o,m==t-1?(m=0,h.push(n(v)),v=0):m++,o=0;for(o=l.charCodeAt(0),r=0;r<16;r++)v=v<<1|1&o,m==t-1?(m=0,h.push(n(v)),v=0):m++,o>>=1}0==--f&&(f=Math.pow(2,p),p++),delete c[l]}else for(o=s[l],r=0;r<p;r++)v=v<<1|1&o,m==t-1?(m=0,h.push(n(v)),v=0):m++,o>>=1;0==--f&&(f=Math.pow(2,p),p++),s[i]=d++,l=String(u)}if(""!==l){if(Object.prototype.hasOwnProperty.call(c,l)){if(l.charCodeAt(0)<256){for(r=0;r<p;r++)v<<=1,m==t-1?(m=0,h.push(n(v)),v=0):m++;for(o=l.charCodeAt(0),r=0;r<8;r++)v=v<<1|1&o,m==t-1?(m=0,h.push(n(v)),v=0):m++,o>>=1}else{for(o=1,r=0;r<p;r++)v=v<<1|o,m==t-1?(m=0,h.push(n(v)),v=0):m++,o=0;for(o=l.charCodeAt(0),r=0;r<16;r++)v=v<<1|1&o,m==t-1?(m=0,h.push(n(v)),v=0):m++,o>>=1}0==--f&&(f=Math.pow(2,p),p++),delete c[l]}else for(o=s[l],r=0;r<p;r++)v=v<<1|1&o,m==t-1?(m=0,h.push(n(v)),v=0):m++,o>>=1;0==--f&&(f=Math.pow(2,p),p++)}for(o=2,r=0;r<p;r++)v=v<<1|1&o,m==t-1?(m=0,h.push(n(v)),v=0):m++,o>>=1;for(;;){if(v<<=1,m==t-1){h.push(n(v));break}m++}return h.join("")},decompress:function(e){return null==e?"":""==e?null:a._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,r){var o,a,s,c,u,i,l,f=[],d=4,p=4,h=3,v="",m=[],b={val:r(0),position:n,index:1};for(o=0;o<3;o+=1)f[o]=o;for(s=0,u=Math.pow(2,2),i=1;i!=u;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=r(b.index++)),s|=(c>0?1:0)*i,i<<=1;switch(s){case 0:for(s=0,u=Math.pow(2,8),i=1;i!=u;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=r(b.index++)),s|=(c>0?1:0)*i,i<<=1;l=e(s);break;case 1:for(s=0,u=Math.pow(2,16),i=1;i!=u;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=r(b.index++)),s|=(c>0?1:0)*i,i<<=1;l=e(s);break;case 2:return""}for(f[3]=l,a=l,m.push(l);;){if(b.index>t)return"";for(s=0,u=Math.pow(2,h),i=1;i!=u;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=r(b.index++)),s|=(c>0?1:0)*i,i<<=1;switch(l=s){case 0:for(s=0,u=Math.pow(2,8),i=1;i!=u;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=r(b.index++)),s|=(c>0?1:0)*i,i<<=1;f[p++]=e(s),l=p-1,d--;break;case 1:for(s=0,u=Math.pow(2,16),i=1;i!=u;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=r(b.index++)),s|=(c>0?1:0)*i,i<<=1;f[p++]=e(s),l=p-1,d--;break;case 2:return m.join("")}if(0==d&&(d=Math.pow(2,h),h++),f[l])v=f[l];else{if(l!==p)return null;v=a+a.charAt(0)}m.push(v),f[p++]=a+v.charAt(0),a=v,0==--d&&(d=Math.pow(2,h),h++)}}};return a}();void 0===(r=function(){return o}.call(t,n,t,e))||(e.exports=r)},2408:(e,t)=>{"use strict";
/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),u=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,m={};function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}function y(){}function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}b.prototype.isReactComponent={},b.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},b.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=b.prototype;var E=g.prototype=new y;E.constructor=g,v(E,b.prototype),E.isPureReactComponent=!0;var w=Array.isArray,S=Object.prototype.hasOwnProperty,_={current:null},O={key:!0,ref:!0,__self:!0,__source:!0};function R(e,t,r){var o,a={},s=null,c=null;if(null!=t)for(o in void 0!==t.ref&&(c=t.ref),void 0!==t.key&&(s=""+t.key),t)S.call(t,o)&&!O.hasOwnProperty(o)&&(a[o]=t[o]);var u=arguments.length-2;if(1===u)a.children=r;else if(1<u){for(var i=Array(u),l=0;l<u;l++)i[l]=arguments[l+2];a.children=i}if(e&&e.defaultProps)for(o in u=e.defaultProps)void 0===a[o]&&(a[o]=u[o]);return{$$typeof:n,type:e,key:s,ref:c,props:a,_owner:_.current}}function T(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function C(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function k(e,t,o,a,s){var c=typeof e;"undefined"!==c&&"boolean"!==c||(e=null);var u=!1;if(null===e)u=!0;else switch(c){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return s=s(u=e),e=""===a?"."+C(u,0):a,w(s)?(o="",null!=e&&(o=e.replace(A,"$&/")+"/"),k(s,t,o,"",(function(e){return e}))):null!=s&&(T(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,o+(!s.key||u&&u.key===s.key?"":(""+s.key).replace(A,"$&/")+"/")+e)),t.push(s)),1;if(u=0,a=""===a?".":a+":",w(e))for(var i=0;i<e.length;i++){var l=a+C(c=e[i],i);u+=k(c,t,o,l,s)}else if(l=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"==typeof l)for(e=l.call(e),i=0;!(c=e.next()).done;)u+=k(c=c.value,t,o,l=a+C(c,i++),s);else if("object"===c)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function x(e,t,n){if(null==e)return e;var r=[],o=0;return k(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function U(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},N={transition:null},D={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:N,ReactCurrentOwner:_};t.Children={map:x,forEach:function(e,t,n){x(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return x(e,(function(){t++})),t},toArray:function(e){return x(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=b,t.Fragment=o,t.Profiler=s,t.PureComponent=g,t.StrictMode=a,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.cloneElement=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=v({},e.props),a=e.key,s=e.ref,c=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,c=_.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(i in t)S.call(t,i)&&!O.hasOwnProperty(i)&&(o[i]=void 0===t[i]&&void 0!==u?u[i]:t[i])}var i=arguments.length-2;if(1===i)o.children=r;else if(1<i){u=Array(i);for(var l=0;l<i;l++)u[l]=arguments[l+2];o.children=u}return{$$typeof:n,type:e.type,key:a,ref:s,props:o,_owner:c}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:c,_context:e},e.Consumer=e},t.createElement=R,t.createFactory=function(e){var t=R.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:i,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:U}},t.memo=function(e,t){return{$$typeof:f,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=N.transition;N.transition={};try{e()}finally{N.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.2.0"},7294:(e,t,n)=>{"use strict";e.exports=n(2408)},9316:(e,t,n)=>{"use strict";n.d(t,{Dz:()=>s,FH:()=>r,H5:()=>a,Hu:()=>o,Kl:()=>c});var r="https://refermate.com",o={LOCK_SCREEN:"lock-screen",UNLOCK_SCREEN:"unlock-screen",OPEN_AFFILIATE_URL:"open_affliate",FETCH_USER:"refer-user-data",FAV_STORE:"favourite-store",UNFAV_STORE:"unfavourite-store",FETCH_STORE_DETAILS:"store-details",FETCH_ALL_STORES:"fetch-all-stores",HOSTPAGE_SEND_FETCH_STORE_DETAILS:"hostpage-store-details",COOKIE:"cookie",RELAY_COOKIE:"relay-cookie",POPUP_UPDATE_CONTENTSCRIPT_STORAGE:"popup-update-content-storage",OPEN_POPUP:"clicked_browser_action",UPDATE_STORE_DETAILS:"update-store-details",RESET_STORAGE_FOR_POPUP:"reset-storage",SUPPORTED_STORE:"supported-store",UNSUPPORTED_STORE:"unsupported-store",AHOY:"ahoy",FEEDBACK:"feedback",CHECK_USER_AUTHENTICATION:"is-user-signed-in",CHECKOUT_PAGE:"checkout-page",APPLY_COUPONS:"apply-coupons",APPLY_COUPONS_CALL:"apply-coupons",PAGE_UPDATED:"page-updated",CHECK_AUTHORIZED_COOKIE:"check-authorized-cookie",AUTHORIZED_COOKIE_RESPONSE:"authorized-cookie-response",CREATE_TAB:"create-tab",STAND_DOWN:"stand-down"},a={REFERMATE_USER:"refermate-user",REFERMATE_STOREDETAILS:"refermate-storedetails-",REFERMATE_ENTIRE_STORE:"refermate-allStores",REFERMATE_FAVOURITE_STORE:"refermate-favourite",REFERMATE_UNFAVOURITE_STORE:"refermate-unfavourite"},s=2880,c=7200},5091:(e,t,n)=>{"use strict";n.d(t,{bp:()=>s,ve:()=>a});n(3224);var r=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function s(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}u((r=r.apply(e,t||[])).next())}))},o=function(e,t){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,r=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}},a=function(e){return 60*e*1e3};function s(e,t,n,a){return r(this,void 0,void 0,(function(){var r,s,c,u;return o(this,(function(o){switch(o.label){case 0:return r=t?"".concat(e).concat(t):"".concat(e),s=new Date,c={value:n,expiry:s.getTime()+a},[4,chrome.storage.local.set((u={},u[r]=JSON.stringify(a?c:{value:n}),u))];case 1:return o.sent(),[2]}}))}))}},1666:(e,t,n)=>{"use strict";n.d(t,{U:()=>u});var r=n(9316),o=(n(5091),n(3224),n(9797)),a=n(189),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function s(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}u((r=r.apply(e,t||[])).next())}))},c=function(e,t){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,r=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}},u=function(e){return s(void 0,void 0,void 0,(function(){var t,n,s,u,i,l,f,d;return c(this,(function(c){switch(c.label){case 0:return[4,chrome.storage.local.get(["currentStoreData"])];case 1:return t=c.sent().currentStoreData,[4,chrome.storage.local.get(["refermate-user"])];case 2:return n=c.sent(),s=0!==Object.keys(n).length?JSON.parse(n["refermate-user"]):null,u=s?JSON.parse(null==s?void 0:s.value):null,[4,(0,o.F)()];case 3:i=c.sent(),c.label=4;case 4:return c.trys.push([4,8,,9]),l={name:"Extension 2 - "+e.eventName,properties:{location:e.location,domain:e.domain||t.store_name,store_id:e.store_id||(null==t?void 0:t.store_id)||0,errorCatchReason:e.errorCatchReason,errorEvent:e.errorEvent,errorMessage:e.errorMessage,uuid:i,version:chrome.runtime.getManifest().version,device:(0,a.nH)(),user_id:(null===(d=null==u?void 0:u.user)||void 0===d?void 0:d.id)||null,sendAhoyMessageFnCount:e.sendAhoyMessageFnCount||null}},void 0===e.domain?[3,7]:[4,fetch(r.FH+"/ahoy_add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})];case 5:return[4,c.sent().json()];case 6:c.sent(),c.label=7;case 7:return[3,9];case 8:return f=c.sent(),console.error("ahoyError",f),[3,9];case 9:return[2]}}))}))}},1466:(e,t,n)=>{"use strict";n.d(t,{F:()=>a});var r=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function s(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}u((r=r.apply(e,t||[])).next())}))},o=function(e,t){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,r=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};function a(e,t){return r(this,void 0,void 0,(function(){var n,r,a,s;return o(this,(function(o){switch(o.label){case 0:return n=e,[4,chrome.storage.local.get("".concat(n,"-alarm"))];case 1:return o.sent().hasOwnProperty("".concat(n,"-alarm"))?[3,6]:[4,chrome.alarms.get(n)];case 2:return void 0!==(r=o.sent())?[3,4]:[4,chrome.storage.local.set((a={},a["".concat(n,"-alarm")]={domain:e,minutesToExpire:Date.now()+60*t*1e3},a))];case 3:return o.sent(),chrome.alarms.create(n,{when:Date.now()+60*t*1e3}),[3,6];case 4:return[4,chrome.storage.local.set((s={},s["".concat(n,"-alarm")]={domain:e,minutesToExpire:r.scheduledTime},s))];case 5:o.sent(),console.log("Alarm task already exists for ".concat(n)),o.label=6;case 6:return[2]}}))}))}},4103:(e,t,n)=>{"use strict";n.d(t,{S6:()=>r});function r(){return!chrome.hasOwnProperty("tabs")}},9435:(e,t,n)=>{"use strict";n.d(t,{EX:()=>r});var r="WN6MZoSkmIs"},3306:(e,t,n)=>{"use strict";n.d(t,{g:()=>r});var r=function(e){var t=e||window.location.hostname,n=e||window.location.href,r=n.includes("developer."),o=n.includes("app."),a=n.includes("refermate.");return{domain:t=r||o||a?null:t.replace(/^cart./,"").replace("http://","").replace("https://","").replace("www.","").replace("www2.","").split(/[/?#]/)[0]}}},189:(e,t,n)=>{"use strict";function r(){var e,t,n,r=!!(null===(e=null===navigator||void 0===navigator?void 0:navigator.platform)||void 0===e?void 0:e.match(/iPhone|iPod|iPad/)),o=-1!==(null===(n=null===(t=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===t?void 0:t.toLowerCase())||void 0===n?void 0:n.indexOf("android"));return r||o}n.d(t,{SB:()=>s,nH:()=>a,vS:()=>c});var o=function(){if("undefined"!=typeof window&&"undefined"!=typeof navigator){var e=null===navigator||void 0===navigator?void 0:navigator.userAgent;return e.match(/chrome|chromium|crios/i)?"chrome":e.match(/firefox|fxios/i)?"firefox":e.match(/safari/i)?"safari":e.match(/opr\//i)?"opera":e.match(/edg/i)?"edge":"No browser detection"}},a=function(){var e,t;return{manufacturer:"undefined"!=typeof window||"undefined"!=typeof navigator?null===navigator||void 0===navigator?void 0:navigator.vendor:"",model:r()?"mobile":"desktop",name:o()||"",type:"browser",version:(null===(t=null===(e=null===navigator||void 0===navigator?void 0:navigator.userAgentData)||void 0===e?void 0:e.brands[0])||void 0===t?void 0:t.version)||""}},s="browser"===a().type&&"safari"===a().name&&"mobile"===a().model,c="browser"===a().type&&"safari"===a().name&&"desktop"===a().model},9797:(e,t,n)=>{"use strict";n.d(t,{F:()=>s});var r=n(8721),o=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function s(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}u((r=r.apply(e,t||[])).next())}))},a=function(e,t){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,r=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}},s=function(){return o(void 0,void 0,void 0,(function(){var e,t,n;return a(this,(function(o){switch(o.label){case 0:return[4,chrome.storage.sync.get(["userExtensionId"])];case 1:return t=o.sent().userExtensionId,e=t,t?[3,3]:(n=(0,r.Z)(),[4,chrome.storage.sync.set({userExtensionId:(0,r.Z)()})]);case 2:o.sent(),e=n,o.label=3;case 3:return[2,e]}}))}))}},7516:(e,t,n)=>{"use strict";n.d(t,{SW:()=>a});var r=n(3445),o={},a=(0,r.Ue)((function(e){return{stores:o,actions:{setStore:function(t){e((function(){return{stores:t}}))}}}}))},9929:(e,t,n)=>{"use strict";n.d(t,{LM:()=>o});var r=n(3445),o=(0,r.Ue)((function(e){return{user:null,actions:{setUser:function(t){e((function(){return{user:t}}))}}}}))},3250:(e,t,n)=>{"use strict";
/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(7294);var o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=r.useState,s=r.useEffect,c=r.useLayoutEffect,u=r.useDebugValue;function i(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(e){return!0}}var l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=a({inst:{value:n,getSnapshot:t}}),o=r[0].inst,l=r[1];return c((function(){o.value=n,o.getSnapshot=t,i(o)&&l({inst:o})}),[e,n,t]),s((function(){return i(o)&&l({inst:o}),e((function(){i(o)&&l({inst:o})}))}),[e]),u(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:l},139:(e,t,n)=>{"use strict";
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(7294),o=n(1688);var a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=o.useSyncExternalStore,c=r.useRef,u=r.useEffect,i=r.useMemo,l=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var f=c(null);if(null===f.current){var d={hasValue:!1,value:null};f.current=d}else d=f.current;f=i((function(){function e(e){if(!u){if(u=!0,s=e,e=r(e),void 0!==o&&d.hasValue){var t=d.value;if(o(t,e))return c=t}return c=e}if(t=c,a(s,e))return t;var n=r(e);return void 0!==o&&o(t,n)?t:(s=e,c=n)}var s,c,u=!1,i=void 0===n?null:n;return[function(){return e(t())},null===i?void 0:function(){return e(i())}]}),[t,n,r,o]);var p=s(e,f[0],f[1]);return u((function(){d.hasValue=!0,d.value=p}),[p]),l(p),p}},1688:(e,t,n)=>{"use strict";e.exports=n(3250)},2798:(e,t,n)=>{"use strict";e.exports=n(139)},8721:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let o;const a=new Uint8Array(16);function s(){if(!o&&(o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!o))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(a)}const c=[];for(let e=0;e<256;++e)c.push((e+256).toString(16).slice(1));function u(e,t=0){return(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase()}const i=function(e,t,n){if(r.randomUUID&&!t&&!e)return r.randomUUID();const o=(e=e||{}).random||(e.rng||s)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=o[e];return t}return u(o)}},3224:(e,t,n)=>{"use strict";
/*! typescript-cookie v1.0.4 | MIT */const r=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),o=e=>encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent),a=decodeURIComponent,s=e=>('"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent));function c(e,t,n){const r=/(?:^|; )([^=]*)=([^;]*)/g,o={};let a;for(;null!=(a=r.exec(document.cookie));)try{const r=n(a[1]);if(o[r]=t(a[2],r),e===r)break}catch(e){}return null!=e?o[e]:o}const u=Object.freeze({decodeName:a,decodeValue:s,encodeName:r,encodeValue:o}),i=Object.freeze({path:"/"});function l(e,t,n=i,{encodeValue:a=o,encodeName:s=r}={}){return document.cookie=`${s(e)}=${a(t,e)}${function(e){return"number"==typeof(e=Object.assign({},e)).expires&&(e.expires=new Date(Date.now()+864e5*e.expires)),null!=e.expires&&(e.expires=e.expires.toUTCString()),Object.entries(e).filter((([e,t])=>null!=t&&!1!==t)).map((([e,t])=>!0===t?`; ${e}`:`; ${e}=${t.split(";")[0]}`)).join("")}(n)}`}function f(e,{decodeValue:t=s,decodeName:n=a}={}){return c(e,t,n)}function d({decodeValue:e=s,decodeName:t=a}={}){return c(void 0,e,t)}(function e(t,n){const r={set:function(e,t,n){return l(e,t,Object.assign({},this.attributes,n),{encodeValue:this.converter.write})},get:function(e){return 0===arguments.length?d(this.converter.read):null!=e?f(e,this.converter.read):void 0},remove:function(e,t){!function(e,t=i){l(e,"",Object.assign({},t,{expires:-1}))}(e,Object.assign({},this.attributes,t))},withAttributes:function(t){return e(this.converter,Object.assign({},this.attributes,t))},withConverter:function(t){return e(Object.assign({},this.converter,t),this.attributes)}},o={attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}};return Object.create(r,o)})({read:u.decodeValue,write:u.encodeValue},i)},3445:(e,t,n)=>{"use strict";n.d(t,{Ue:()=>u});var r=n(3973),o=n(7294),a=n(2798);const{useSyncExternalStoreWithSelector:s}=a;const c=e=>{"function"!=typeof e&&console.warn('[DEPRECATED] Passing a vanilla store will be unsupported in the future version. Please use `import { useStore } from "zustand"` to use the vanilla store in React.');const t="function"==typeof e?(0,r.M)(e):e,n=(e,n)=>function(e,t=e.getState,n){const r=s(e.subscribe,e.getState,e.getServerState||e.getState,t,n);return(0,o.useDebugValue)(r),r}(t,e,n);return Object.assign(n,t),n},u=e=>e?c(e):c},3973:(e,t,n)=>{"use strict";n.d(t,{M:()=>o});const r=e=>{let t;const n=new Set,r=(e,r)=>{const o="function"==typeof e?e(t):e;if(!Object.is(o,t)){const e=t;t=(null!=r?r:"object"!=typeof o)?o:Object.assign({},t,o),n.forEach((n=>n(t,e)))}},o=()=>t,a={setState:r,getState:o,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The destroy method will be unsupported in the future version. You should use unsubscribe function returned by subscribe. Everything will be garbage collected if store is garbage collected."),n.clear()}};return t=e(r,o,a),a},o=e=>e?r(e):r}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(6961),t=n.n(e),r=n(9316),o=n(5091),a=n(1666),s=n(4103),c=n(8721),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function s(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}u((r=r.apply(e,t||[])).next())}))},i=function(e,t){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,r=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}},l=n(3306),f=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function s(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}u((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,r=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};const p=function(e){return f(void 0,void 0,void 0,(function(){var n,o,a,s,c,u,i;return d(this,(function(l){switch(l.label){case 0:return e?[4,chrome.storage.local.get(r.H5.REFERMATE_ENTIRE_STORE)]:[2];case 1:return n=l.sent(),Object.keys(n).length?[4,JSON.parse(t().decompressFromUTF16(JSON.parse(n[r.H5.REFERMATE_ENTIRE_STORE]).value))]:[2,null];case 2:for(o=l.sent(),a=Object.values(o),s=0,c=a.length;s<c;++s)if((null===(u=a[s])||void 0===u?void 0:u.domains.includes(e))&&(null===(i=a[s])||void 0===i?void 0:i.ext))return[2,a[s]];return[2]}}))}))};var h=n(9929),v=n(7516),m=n(189);var b=n(9435),y=n(1466),g=function(){return g=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},g.apply(this,arguments)},E=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function s(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}u((r=r.apply(e,t||[])).next())}))},w=function(e,t){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,r=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};console.log=function(){},console.error=function(){},console.debug=function(){};chrome.storage.local.get(["extension_state"],(function(e){return E(void 0,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return"permissions_granted"===e.extension_state||void 0!==e.extension_state?[2]:void 0!==e.extension_state?[3,7]:[4,chrome.storage.local.set({extension_state:"installed"})];case 1:return t.sent(),m.SB?[4,chrome.tabs.create({url:"https://refermate.com/extension_ios_instructions"})]:[3,3];case 2:t.sent(),t.label=3;case 3:return m.vS?[4,chrome.tabs.create({url:"https://refermate.com/extension_installed_apple_permissions_instructions"})]:[3,5];case 4:t.sent(),t.label=5;case 5:return m.vS||m.SB?[4,chrome.action.setBadgeText({text:"Allow Permissions"})]:[3,7];case 6:t.sent(),t.label=7;case 7:return[2]}}))}))}));var S=function(e,t,n){return E(void 0,void 0,void 0,(function(){var r,o;return w(this,(function(a){switch(a.label){case 0:return r=new URL(e).hostname,o=Math.floor(Date.now()/1e3)+1800,console.log("setStandDownCookie:",{url:e,value:t,calledBy:n,hostname:r}),[4,chrome.cookies.set({domain:r,name:"standDown",url:e,expirationDate:o,value:String(t),secure:!0,path:"/"})];case 1:return a.sent(),[2]}}))}))},_=function(e,t){return E(void 0,void 0,void 0,(function(){return w(this,(function(e){switch(e.label){case 0:return[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},O=function(e,t){return E(void 0,void 0,void 0,(function(){return w(this,(function(n){switch(n.label){case 0:return[3,7];case 1:return n.sent(),[4,chrome.action.setBadgeBackgroundColor({color:"#190708",tabId:t})];case 2:return n.sent(),[4,chrome.action.setBadgeTextColor({color:"#fefeff",tabId:t})];case 3:n.sent(),n.label=4;case 4:return 0!=+e?[3,7]:[4,chrome.action.setBadgeBackgroundColor({color:"#190708",tabId:t})];case 5:return n.sent(),[4,chrome.action.setBadgeTextColor({color:"#fefeff",tabId:t})];case 6:n.sent(),n.label=7;case 7:return+e>0?[4,chrome.action.setBadgeText({text:e,tabId:t})]:[3,9];case 8:return n.sent(),[3,11];case 9:return 0!=+e?[3,11]:[4,chrome.action.setBadgeText({text:"",tabId:t})];case 10:n.sent(),n.label=11;case 11:return[2]}}))}))};chrome.cookies.onChanged.addListener((function(e){return E(void 0,void 0,void 0,(function(){var n,o;return w(this,(function(a){switch(a.label){case 0:return"explicit"!==e.cause||e.removed||".linksynergy.com"!==e.cookie.domain||e.cookie.value.includes(b.EX)?[3,2]:(n=e.cookie.name.slice(11),[4,(s=n,E(void 0,void 0,void 0,(function(){var e,n,o,a,c,u;return w(this,(function(i){switch(i.label){case 0:return s?[4,chrome.storage.local.get(r.H5.REFERMATE_ENTIRE_STORE)]:[2];case 1:return e=i.sent(),Object.keys(e).length?[4,JSON.parse(t().decompressFromUTF16(JSON.parse(e[r.H5.REFERMATE_ENTIRE_STORE]).value))]:[2,null];case 2:for(n=i.sent(),o=Object.values(n),a=0,c=o.length;a<c;++a)if((null===(u=o[a])||void 0===u?void 0:u.mid)===s)return[2,o[a]];return[2]}}))})))]);case 1:o=a.sent(),chrome.cookies.getAllCookieStores((function(t){console.log("Cookie - cookieStores",t);for(var a=t[0].tabIds,s=function(t){chrome.webNavigation.getFrame({tabId:a[t],frameId:0},(function(s){return E(void 0,void 0,void 0,(function(){return w(this,(function(c){switch(c.label){case 0:return(null==s?void 0:s.url.includes("http"))?(console.log("Cookie - Tab: ".concat(t),s),console.log("Cookie - Details:",{changedInfo:e.cookie.value,mid:n,storeFromMid:o,cleanedHostName:new URL(null==s?void 0:s.url).hostname,formattedURL:"www.".concat(null==o?void 0:o.domains[0])}),(null==s?void 0:s.url.includes(null==o?void 0:o.domains[0]))?[4,S("https://www.".concat(null==o?void 0:o.domains[0]),a[t],"cookie-listener")]:[3,4]):[3,4];case 1:return c.sent(),[4,_(a[t])];case 2:return c.sent(),[4,chrome.tabs.sendMessage(a[t],{type:r.Hu.STAND_DOWN})];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}))},c=0;c<t[0].tabIds.length;c++)s(c)})),a.label=2;case 2:return[2]}var s}))}))})),chrome.webNavigation.onCommitted.addListener((function(e){var t,n;if(!e.url.includes("refermate.com/")&&(!e.url.includes("chrome-extension://")&&!e.url.includes("devtools://")&&!e.url.includes("click.linksynergy.com")&&"outermost_frame"===e.frameType)){(t=e.url,n=e.tabId,E(void 0,void 0,void 0,(function(){var e,r;return w(this,(function(o){switch(o.label){case 0:return e=new URL(t).hostname,r=Math.floor(Date.now()/1e3)+1800,[4,chrome.cookies.set({domain:e,name:"currentTab",url:t,expirationDate:r,value:String(n),secure:!0,path:"/"})];case 1:return o.sent(),[2]}}))}))).catch();var r=(0,l.g)(e.url).domain,o=new URL(e.url).hostname;console.log("listen",e),p(r).then((function(t){return E(void 0,void 0,void 0,(function(){var n,r,a,s;return w(this,(function(c){switch(c.label){case 0:return t&&(null==t?void 0:t.ext)?[3,3]:[4,S(e.url,!1,1)];case 1:return c.sent(),[4,_(e.tabId)];case 2:return c.sent(),console.log("0A. Listen: Store Not Supported, Returning Early, Not Standing Down",e.url),[2];case 3:return!(null==t?void 0:t.ext)||(null==t?void 0:t.mid)?[3,6]:[4,S(e.url,!1,2)];case 4:return c.sent(),[4,O(String(t.coupons_count),e.tabId)];case 5:return c.sent(),console.log("0B. Listen: Store supported, no MID (non-Rakuten), ext=true, Returning Early, Not Standing Down",e.url),[2];case 6:return console.log("0C. Listen: Supported",e.url,{mid:t.mid,ext:t.ext}),e.url.includes("ranSiteID")?(n=function(e,t){var n=e.split("?")[1];if(n)for(var r=n.split("&"),o=0;o<r.length;o++){var a=r[o].split("=");if(a[0]===t)return decodeURIComponent(a[1])}return null}(e.url,"ranEAID"),console.log("1A. Listen: URL contains RAN",{myRanEAID:b.EX,pageRanEAID:n}),n!==b.EX?[3,9]:[4,S(e.url,!1,3)]):[3,16];case 7:return c.sent(),[4,O(String(t.coupons_count),e.tabId)];case 8:return c.sent(),console.log("2A. Listen: Our RAN EAID, Not Standing Down, Returning Early"),[2];case 9:return n===b.EX?[3,16]:[4,chrome.cookies.get({url:"https://.linksynergy.com",name:"lsclick_mid"+"".concat(t.mid)})];case 10:return(null==(r=c.sent())?void 0:r.value.includes(b.EX))?[4,S(e.url,!1,4)]:[3,13];case 11:return c.sent(),[4,O(String(t.coupons_count),e.tabId)];case 12:return c.sent(),console.log("2B. Listen: Not Our RAN EAID, Our RAN Cookie, Not Standing Down"),[2];case 13:return(null==r?void 0:r.value.includes(b.EX))?[3,16]:[4,S(e.url,e.tabId,5)];case 14:return c.sent(),[4,_(e.tabId)];case 15:return c.sent(),console.log("2C. Listen: Not Our RAN EAID, Not Our RAN Cookie, Standing Down"),[2];case 16:return e.url.includes("ranSiteID")?[3,24]:(console.log("1B. Listen: URL does not contain RAN"),[4,chrome.cookies.get({url:"https://.".concat(o),name:"standDown"})]);case 17:return a=c.sent(),[4,chrome.cookies.get({url:"https://.".concat(o),name:"currentTab"})];case 18:return s=c.sent(),(null==a?void 0:a.value)!==(null==s?void 0:s.value)?[3,21]:(console.log("1B.1A Listen: Matching Cookies",{standDownCookie:null==a?void 0:a.value,currentTabCookie:null==s?void 0:s.value}),[4,S(e.url,e.tabId,6)]);case 19:return c.sent(),[4,_(e.tabId)];case 20:c.sent(),console.log("1B.2A Listen: Standing Down"),c.label=21;case 21:return(null==a?void 0:a.value)===(null==s?void 0:s.value)?[3,24]:(console.log("1B.1B Listen: Not Matching Cookies",{standDownCookie:null==a?void 0:a.value,currentTabCookie:null==s?void 0:s.value}),[4,S(e.url,!1,7)]);case 22:return c.sent(),[4,O(String(t.coupons_count),e.tabId)];case 23:c.sent(),console.log("1B.2B Listen: Not Standing Down"),c.label=24;case 24:return[2]}}))}))}))}})),E(void 0,void 0,void 0,(function(){var e,t,n;return w(this,(function(r){switch(r.label){case 0:return[4,chrome.tabs.query({active:!0,currentWindow:!0})];case 1:return e=r.sent()[0],t=(0,l.g)(e.url).domain,[4,p(t)];case 2:return(n=r.sent())?[4,chrome.storage.local.set({currentDomain:t})]:[3,4];case 3:r.sent(),r.label=4;case 4:return n?[3,6]:[4,chrome.storage.local.set({currentDomain:null})];case 5:r.sent(),r.label=6;case 6:return[2]}}))})),chrome.tabs.onUpdated.addListener((function(e,t,n){return E(void 0,void 0,void 0,(function(){var e,n,r;return w(this,(function(o){switch(o.label){case 0:return[4,chrome.storage.local.get("currentDomain")];case 1:return e=o.sent(),t.url?(n=(0,l.g)(t.url).domain)===e?[3,6]:[4,p(n)]:[3,6];case 2:return(r=o.sent())?[4,chrome.storage.local.set({currentDomain:n})]:[3,4];case 3:o.sent(),o.label=4;case 4:return r?[3,6]:[4,chrome.storage.local.set({currentDomain:null})];case 5:o.sent(),o.label=6;case 6:return[2]}}))}))})),chrome.tabs.query({active:!0,currentWindow:!0}).then((function(e){var t=e[0];(0,l.g)(t.url)})),chrome.runtime.onInstalled.addListener((function(e){return E(void 0,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return e&&"install"===e.reason?[4,chrome.storage.sync.set({userExtensionId:(0,c.Z)()})]:[3,3];case 1:return t.sent(),m.SB&&m.vS?[3,3]:[4,chrome.storage.local.set({refermateTutorial:[]})];case 2:t.sent(),chrome.tabs.query({url:"*://*.refermate.com/*"},(function(e){0===e.length&&chrome.tabs.create({url:r.FH+"/extension_installed"},(function(){return E(void 0,void 0,void 0,(function(){return w(this,(function(e){switch(e.label){case 0:return[4,(0,a.U)({domain:"refermate.com",eventName:"Extension Install",location:"background.ts",store_id:"No Store - Background Process",errorCatchReason:null,errorEvent:null,errorMessage:null,sendAhoyMessageFnCount:1})];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))})),t.label=3;case 3:return e&&"update"===e.reason?[4,(0,a.U)({domain:"refermate.com",eventName:"Extension Update",location:"background.ts",store_id:"No Store - Background Process",errorCatchReason:null,errorEvent:null,errorMessage:null,sendAhoyMessageFnCount:2})]:[3,5];case 4:t.sent(),t.label=5;case 5:return e.reason===chrome.runtime.OnInstalledReason.INSTALL&&chrome.runtime.setUninstallURL("".concat(r.FH,"/extension_uninstalled")),[2,!0]}}))}))})),chrome.tabs.onUpdated.addListener((function(e,t){return"complete"===t.status&&chrome.tabs.sendMessage(e,{type:r.Hu.PAGE_UPDATED},(function(e){return console.log(e)})),!0}));var R=function(e){return E(void 0,void 0,void 0,(function(){var t;return w(this,(function(n){switch(n.label){case 0:return[4,chrome.tabs.query({active:!0,lastFocusedWindow:!0})];case 1:return(null==(t=n.sent()[0])?void 0:t.id)&&chrome.tabs.sendMessage(t.id,e,(function(e){return console.log("respondToContentscript",e)})),[2]}}))}))},T=function(e,t){return E(void 0,void 0,void 0,(function(){var n,a,c,u;return w(this,(function(i){switch(i.label){case 0:return i.trys.push([0,7,,8]),[4,p(e)];case 1:return n=i.sent(),console.log("Step 4",n),n?[4,fetch("".concat(r.FH,"/extension?ver=2&domain=").concat(e,"&scope=domain"))]:[2];case 2:return[4,i.sent().json()];case 3:return a=i.sent(),console.log("✅✅✅✅✅ fetchStoreDetails request from %o",t),[4,(0,o.bp)(r.H5.REFERMATE_STOREDETAILS,e,JSON.stringify(null==a?void 0:a.domains[0]),(0,o.ve)(r.Kl))];case 4:return i.sent(),c="".concat(r.H5.REFERMATE_STOREDETAILS).concat(e),(0,s.S6)()?[3,6]:(console.log("Fired Alarm for %o",e),[4,(0,y.F)(c,r.Dz)]);case 5:i.sent(),i.label=6;case 6:return[3,8];case 7:throw u=i.sent(),console.error("Error calling fetchStoreDetails:",u),u;case 8:return[2]}}))}))},A=function(e){return E(void 0,void 0,void 0,(function(){var t,n;return w(this,(function(a){switch(a.label){case 0:return a.trys.push([0,5,,6]),console.log("✅✅✅✅✅ fetchUserDetails request from %o",e),[4,fetch("https://refermate.com/extension?ver=2&scope=user,activity,transactions,store_subscriptions,liked_products&per_page=5")];case 1:return[4,a.sent().json()];case 2:return t=a.sent(),console.log("fetchUserDetails result res",t),t.user?(console.log("WE HAVE USER BUT WE ARE SETTING NOW...."),[4,(0,o.bp)(r.H5.REFERMATE_USER,null,JSON.stringify(t),null)]):[3,4];case 3:a.sent(),a.label=4;case 4:return[3,6];case 5:throw n=a.sent(),console.error("Error calling fetchUserDetails:",n),n;case 6:return[2]}}))}))},C=function(e){return E(void 0,void 0,void 0,(function(){var n,a,s;return w(this,(function(c){switch(c.label){case 0:return c.trys.push([0,4,,5]),console.log("🔥🔥🔥🔥🔥 fetchAllStores request from %o",e),[4,fetch(r.FH+"/extension?ver=3&store_list=true")];case 1:return[4,c.sent().json()];case 2:return n=c.sent(),a=JSON.parse(n.stores),[4,(0,o.bp)(r.H5.REFERMATE_ENTIRE_STORE,null,t().compressToUTF16(JSON.stringify(a)),(0,o.ve)(r.Kl))];case 3:return c.sent(),v.SW.getState().actions.setStore(a),[3,5];case 4:return s=c.sent(),console.log("Error fetching all stores:",s),[3,5];case 5:return[2]}}))}))},k=function(e){return E(void 0,void 0,void 0,(function(){var t,n;return w(this,(function(o){switch(o.label){case 0:if(!e)return[2];o.label=1;case 1:return o.trys.push([1,6,,7]),[4,fetch("https://refermate.com/extension?ver=2&scope=user,activity,transactions,store_subscriptions,liked_products&per_page=5")];case 2:return[4,o.sent().json()];case 3:return t=o.sent(),console.log("USER 1: FETCHING DATA FROM:",e,t.user),t.user?[3,5]:(h.LM.getState().actions.setUser(null),[4,chrome.storage.local.remove(r.H5.REFERMATE_USER)]);case 4:o.sent(),o.label=5;case 5:return[3,7];case 6:return n=o.sent(),console.log("Error checking user authentication:",n),[3,7];case 7:return[2]}}))}))};chrome.alarms&&chrome.alarms.onAlarm.addListener((function(e){return E(void 0,void 0,void 0,(function(){var t,n,r;return w(this,(function(o){switch(o.label){case 0:return console.log("Alarm Fired",e),t=e.name,n="".concat(t,"-alarm"),r="".concat(t),[4,chrome.storage.local.get(n)];case 1:return o.sent().hasOwnProperty(n)?[4,chrome.storage.local.remove([r,n])]:[3,3];case 2:o.sent(),console.log("Alarm Fired and Removed",t),o.label=3;case 3:return[2]}}))}))})),chrome.runtime.onMessage.addListener((function(e,t,n){return E(void 0,void 0,void 0,(function(){var t,s,c,l,f,d,p,h,v,m,b,y,S,_,O,x;return w(this,(function(U){switch(U.label){case 0:switch(t="object"==typeof e&&Object.hasOwn(e,"type")?e.type:e,t){case r.Hu.CREATE_TAB:return[3,1];case r.Hu.LOCK_SCREEN:return[3,4];case"notification":return[3,6];case r.Hu.UNLOCK_SCREEN:return[3,7];case r.Hu.CHECK_USER_AUTHENTICATION:return[3,9];case r.Hu.FETCH_USER:return[3,11];case r.Hu.FAV_STORE:return[3,13];case r.Hu.AHOY:return[3,16];case r.Hu.UNFAV_STORE:return[3,18];case r.Hu.COOKIE:return[3,19];case r.Hu.FEEDBACK:return[3,21];case r.Hu.RELAY_COOKIE:return[3,23];case r.Hu.OPEN_AFFILIATE_URL:return[3,26];case r.Hu.FETCH_STORE_DETAILS:return[3,28];case r.Hu.FETCH_ALL_STORES:return[3,30];case r.Hu.CHECKOUT_PAGE:return[3,32]}return[3,34];case 1:return[4,chrome.tabs.update({url:e.options.url})];case 2:return U.sent(),[4,chrome.action.setBadgeText({text:""})];case 3:case 10:case 12:case 15:case 17:case 20:case 22:case 25:case 29:case 31:case 33:return U.sent(),n(!0),[3,34];case 4:case 7:return[4,chrome.tabs.query({active:!0,lastFocusedWindow:!0})];case 5:return(null==(s=U.sent()[0])?void 0:s.id)&&chrome.tabs.sendMessage(s.id,{type:r.Hu.LOCK_SCREEN},(function(e){return console.log("respondToContentscript","Message: {lockContent: MESSAGE_TOPIC.LOCK_SCREEN")})),n(!0),[3,34];case 6:return chrome.notifications&&chrome.notifications.create("store-cleared",e.data),[3,34];case 8:return(null==(c=U.sent()[0])?void 0:c.id)&&chrome.tabs.sendMessage(c.id,{type:r.Hu.UNLOCK_SCREEN},(function(e){return console.log("respondToContentscript","Message: {lockContent: MESSAGE_TOPIC.UNLOCK_SCREEN")})),n(!0),[3,34];case 9:return[4,k(e.sender)];case 11:return[4,A(e.sender)];case 13:return[4,(N=e.data,E(void 0,void 0,void 0,(function(){var e,t;return w(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,fetch(r.FH+"/stores/"+N.id+"/subscription.json",{method:"POST",body:JSON.stringify({subscribe:!0}),headers:{"content-type":"application/json"}})];case 1:return n.sent(),e={type:r.Hu.FAV_STORE,data:"subscribed"},[4,R(e)];case 2:return n.sent(),[3,4];case 3:throw t=n.sent(),console.error("Error storing favorite:",t),t;case 4:return[2]}}))})))];case 14:return U.sent(),[4,chrome.storage.local.set({invalidatepopup:!0})];case 16:return[4,(0,a.U)(g({},e.ahoyData))];case 18:return function(e){return E(void 0,void 0,void 0,(function(){var t,n;return w(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,fetch(r.FH+"/stores/"+e.id+"/subscription.json",{method:"POST",body:JSON.stringify({subscribe:!1}),headers:{"content-type":"application/json"}})];case 1:return o.sent(),t={type:r.Hu.UNFAV_STORE,data:"removed"},[4,R(t)];case 2:return o.sent(),[3,4];case 3:throw n=o.sent(),console.error("Error calling unfavouriteStore:",n),n;case 4:return[2]}}))}))}(e.data).then((function(){return E(void 0,void 0,void 0,(function(){return w(this,(function(e){switch(e.label){case 0:return[4,chrome.storage.local.set({invalidatepopup:!0})];case 1:return e.sent(),[2]}}))}))})),n(!0),[3,34];case 19:return l=e.data,f=l.key,d=l.value,p=l.namespace,h=l.ttl,[4,(0,o.bp)(f,p,d,(0,o.ve)(h))];case 21:return[4,(I={kind:"extension_rating",body:{feedbackText:e.data.feedback,stars:e.data.stars}},u(void 0,void 0,void 0,(function(){var e,t,n,o;return i(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),e={feedback:{kind:I.kind="extension_rating",body:I.body.feedbackText,star_rating:I.body.stars}},[4,fetch(r.FH+"/feedbacks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})];case 1:return[4,(t=a.sent()).json()];case 2:return n=a.sent(),t.ok&&console.log("👍 Feedback:",n,"\nResponse:",t),[3,4];case 3:return o=a.sent(),console.error("feedbackError",o),[3,4];case 4:return[2]}}))})))];case 23:return v=e.data,m=v.key,b=v.value,y=v.namespace,S=v.ttl,[4,(0,o.bp)(m,y,b,(0,o.ve)(S))];case 24:return U.sent(),_={type:r.Hu.RELAY_COOKIE,data:{key:m,value:b,expiration:(0,o.ve)(S)}},[4,R(_)];case 26:return[4,chrome.tabs.query({})];case 27:return O=U.sent(),""!==e.data.affiliateUrl?(console.log("All tabs",O),chrome.tabs.create({url:e.data.affiliateUrl,active:!1,pinned:!0},(function(e){setTimeout((function(){return E(void 0,void 0,void 0,(function(){var t,n,r,o,a;return w(this,(function(s){switch(s.label){case 0:return null==(null==e?void 0:e.id)?[3,6]:[4,chrome.tabs.remove(e.id)];case 1:return s.sent(),[4,chrome.tabs.query({})];case 2:if(t=s.sent(),n=function(e,t){for(var n=[],r=new Set(e.map((function(e){return e.id}))),o=0,a=t;o<a.length;o++){var s=a[o];r.has(s.id)||n.push(s)}return n}(Array.from(O),Array.from(t)),!(n.length>0))return[3,6];r=0,o=n,s.label=3;case 3:return r<o.length?(a=o[r],[4,chrome.tabs.remove(a.id)]):[3,6];case 4:s.sent(),s.label=5;case 5:return r++,[3,3];case 6:return[2]}}))}))}),8e3)}))):console.log("No affiliate URL to open"),n(!0),[3,34];case 28:return[4,T(e.storeDomain,e.sender)];case 30:return[4,C(e.sender)];case 32:return[4,chrome.storage.local.set((x={},x[r.Hu.CHECKOUT_PAGE]=e.data,x))];case 34:return[2,!0]}var I,N}))}))}))})()})();